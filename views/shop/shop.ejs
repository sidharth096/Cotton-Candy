
<style>
    p,
    li,
    a {
      font-size: 14px;
    }
  
    /* GRID */
    .eleven {
      width: 91.53%;
    }
    .one {
      width: 6.866%;
    }
    .pagination {
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
    }
    .pagination ul {
      margin: 0;
      padding: 0;
      list-style-type: none;
    }
    .p1 a:hover {
      background-color: #000000;
      border-radius: 40%;
      color: #fff;
    }
    .pagination a {
      display: inline-block;
      padding: 10px 18px;
      color: #222;
    }
  
    /* ONE */
  
    .p1 a {
      width: 40px;
      height: 40px;
      line-height: 40px;
      padding: 0;
      text-align: center;
    }
  
    .p1 a.is-active {
      background-color: #000000;
      border-radius: 100%;
      color: #fff;
    }
  
    .p11 a {
      background-color: #000000;
      margin: auto 5px;
      color: #fff;
      border: 3px solid #000000;
      position: relative;
    }
    .p11 a:hover {
      background-color: #051a0d;
      color: #fff;
      border: 3px solid #cef8df;
    }
    .p11 a:first-of-type:before {
      content: "";
      position: absolute;
      top: -3px;
      left: -25px;
      border-top: 22px solid transparent;
      border-bottom: 22px solid transparent;
      border-right: 22px solid #000000;
    }
  
    .p11 a:last-of-type:after {
      content: "";
      position: absolute;
      top: -3px;
      right: -25px;
      border-top: 22px solid transparent;
      border-bottom: 22px solid transparent;
      border-left: 22px solid #000000;
    }
  
    .p11 .is-active {
      font-weight: bold;
    }
.product__item__text h3 span{
    color: #b7b7b7;
    font-size: 17px;
    font-weight: 400;
    margin-left: 10px;
    text-decoration: line-through;
}
.d-flex{
     align-items: baseline;
}
    </style>
<% var username=username || '' ; %>
<% var Wishlistcount=Wishlistcount|| 0 ; %>
<% var cartCount=cartCount|| 0 ; %>
<% if (username) { %>
    <%-include('../partials/userheader',{username,Wishlistcount,cartCount})-%>

 <% }else{%>
    <%-include('../partials/userheader')-%>
<% } %>
 

                        <!-- Breadcrumb Section Begin -->
                        <section class="breadcrumb-option">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="breadcrumb__text">
                                            <h4>Shop</h4>
                                            <div class="breadcrumb__links">
                                                <a href="/home">Home</a>
                                                <span>Shop</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- Breadcrumb Section End -->

                        <!-- Shop Section Begin -->
                        <section class="shop spad">
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-3">
                                        <div class="shop__sidebar">
                                            <div class="shop__sidebar__search">
                                                
                                                <form action="/search" method="get">
                                                    <input type="text" name="query" placeholder="Search...">
                                                    <button type="submit"><span class="icon_search"></span></button>
                                                </form>

                                            </div>
                                            <div class="shop__sidebar__accordion">
                                                <div class="accordion" id="accordionExample">
                                                    <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseOne">Categories</a>
                                                        </div>
                                                        <div id="collapseOne" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__categories">
                                                                    <ul class="nice-scroll">
                                                                        <% categories.forEach(function(category) { %>
                                                                            <li><a
                                                                                    href="/category/<%=category.categoryname%>">
                                                                                    <%=category.categoryname %> ()
                                                                                </a></li>
                                                                            <% }); %>
                                                                                <!-- <li><a href="/categoryshirt">Shirt (20)</a></li>
                                                                        <li><a href="/categorytshirt">Tshirt (20)</a></li>
                                                                        <li><a href="/categoryhoddie">Hoddie (20)</a></li>
                                                                        <li><a href="/categoryshorts">Shorts (20)</a></li>
                                                                        <li><a href="/categorycargo">Cargo (20)</a></li>
                                                                        <li><a href="/categorytrackpant">Trak pant (20)</a></li>
                                                                        <li><a href="/categorycottonpant">Cotton pants (20)</a></li>
                                                                        <li><a href="/categorycap">Cap (20)</a></li> -->
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseTwo">Branding</a>
                                                        </div>
                                                        <div id="collapseTwo" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__brand">
                                                                    <ul>
                                                                        <li><a href="#">Levis</a></li>
                                                                        <li><a href="#">US Polo</a></li>
                                                                        <li><a href="#">Luis Phillipi</a></li>
                                                                        <li><a href="#">Max</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div> -->
                                                    <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseThree">Filter Price</a>
                                                        </div>
                                                        <div id="collapseThree" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__price">
                                                                    <ul>
                                                                        <li><a href="#">₹100 - ₹500</a></li>
                                                                        <li><a href="#">₹500 - ₹1000</a></li>
                                                                        <li><a href="#">₹1000- ₹1500</a></li>
                                                                        <li><a href="#">₹1500- ₹2500</a></li>
                                                                        <li><a href="#">₹2500 -₹4000</a></li>
                                                                        <li><a href="#">₹4000+</a></li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseFour">Size</a>
                                                        </div>
                                                        <div id="collapseFour" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__size">
                                                                    <label for="xs">xs
                                                                        <input type="radio" id="xs">
                                                                    </label>
                                                                    <label for="sm">s
                                                                        <input type="radio" id="sm">
                                                                    </label>
                                                                    <label for="md">m
                                                                        <input type="radio" id="md">
                                                                    </label>
                                                                    <label for="xl">xl
                                                                        <input type="radio" id="xl">
                                                                    </label>
                                                                    <label for="2xl">2xl
                                                                        <input type="radio" id="2xl">
                                                                    </label>
                                                                    <label for="xxl">xxl
                                                                        <input type="radio" id="xxl">
                                                                    </label>
                                                                    <label for="3xl">3xl
                                                                        <input type="radio" id="3xl">
                                                                    </label>
                                                                    <label for="4xl">4xl
                                                                        <input type="radio" id="4xl">
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseFive">Colors</a>
                                                        </div>
                                                        <div id="collapseFive" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__color">
                                                                    <label class="c-1" for="sp-1">
                                                                        <input type="radio" id="sp-1">
                                                                    </label>
                                                                    <label class="c-2" for="sp-2">
                                                                        <input type="radio" id="sp-2">
                                                                    </label>
                                                                    <label class="c-3" for="sp-3">
                                                                        <input type="radio" id="sp-3">
                                                                    </label>
                                                                    <label class="c-4" for="sp-4">
                                                                        <input type="radio" id="sp-4">
                                                                    </label>
                                                                    <label class="c-5" for="sp-5">
                                                                        <input type="radio" id="sp-5">
                                                                    </label>
                                                                    <label class="c-6" for="sp-6">
                                                                        <input type="radio" id="sp-6">
                                                                    </label>
                                                                    <label class="c-7" for="sp-7">
                                                                        <input type="radio" id="sp-7">
                                                                    </label>
                                                                    <label class="c-8" for="sp-8">
                                                                        <input type="radio" id="sp-8">
                                                                    </label>
                                                                    <label class="c-9" for="sp-9">
                                                                        <input type="radio" id="sp-9">
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card">
                                                        <div class="card-heading">
                                                            <a data-toggle="collapse"
                                                                data-target="#collapseSix">Tags</a>
                                                        </div>
                                                        <div id="collapseSix" class="collapse show"
                                                            data-parent="#accordionExample">
                                                            <div class="card-body">
                                                                <div class="shop__sidebar__tags">
                                                                    <a href="#">Product</a>
                                                                    <a href="#">Bags</a>
                                                                    <a href="#">Shoes</a>
                                                                    <a href="#">Fashio</a>
                                                                    <a href="#">Clothing</a>
                                                                    <a href="#">Hats</a>
                                                                    <a href="#">Accessories</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-9">
                                        <div class="shop__product__option">
                                            <div class="row">
                                                <div class="col-lg-6 col-md-6 col-sm-6">
                                                    <div class="shop__product__option__left">
                                                     
                                                    </div>
                                                </div>
                                                <!-- <div class="col-lg-6 col-md-6 col-sm-6">
                                                    <div class="shop__product__option__right">
                                                        <p>Sort by Price:</p>
                                                        <select>
                                                            <option value="">Low To High</option>
                                                            <option value="">₹0 - ₹1000</option>
                                                            <option value="">₹1000 - ₹2000</option>
                                                        </select>
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                        <div class="row">

                                            <% products.forEach(function(product) { %>
                                                <div class="col-lg-4 col-md-6 col-sm-6">
                                                    <div class="product__item">
                                                        <a href="/productdetail/<%=product._id%>">
                                                            <div class="product__item__pic set-bg">
                                                                <img src="uploads/<%= product.productimage[3]%>">
                                                                <ul class="product__hover">
                                                                    <!-- <li><a href="">
                                                                        <img src="img/icon/heart.png"alt=""></a>
                                                                    </li> -->
                                                                    <li><a href="#" data-value="<%= product._id%>"
                                                                        class="add-produtToWishlist"><img src="img/icon/heart.png"alt="">
                                                                           </a></li>
                                                                    <li class="cartimg"><a type="button"
                                                                            data-pro="<%=product._id %>"
                                                                            class="cartIncrement add-cart"><img
                                                                                src="img/shopping-cart.png" alt="">
                                                                        </a>
                                                                    </li>
                                                                    <!-- <li><a href="#"><img src="img/icon/search.png"
                                                                            alt=""></a></li> -->
                                                                </ul>
                                                            </div>
                                                        </a>

                                                        <div class="product__item__text">
                                                            <h5>
                                                                <%=product.productname %>
                                                            </h5>

                                                            <!-- <div class="rating">
                                                                <i class="fa fa-star-o"></i>
                                                                <i class="fa fa-star-o"></i>
                                                                <i class="fa fa-star-o"></i>
                                                                <i class="fa fa-star-o"></i>
                                                                <i class="fa fa-star-o"></i>
                                                            </div> -->
                                                            <div class="d-flex">
                                                                <h5 class="mr-3">
                                                                    &#x20B9;<%=product.productpromotionalprice %>
                                                                </h5>
                                                                <h3>
                                                                    <span>
                                                                        &#x20B9;<%=product.productregularprice %>

                                                                    </span>
                                                                </h3>

                                                            </div>

                                                            <!-- <div class="product__color__select">
                                                                <label for="pc-4">
                                                                    <input type="radio" id="pc-4">
                                                                </label>
                                                                <label class="active black" for="pc-5">
                                                                    <input type="radio" id="pc-5">
                                                                </label>
                                                                <label class="grey" for="pc-6">
                                                                    <input type="radio" id="pc-6">
                                                                </label>
                                                            </div> -->
                                                        </div>
                                                    </div>
                                                </div>
                                                <% }); %>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="product__pagination">
                                                    <div class="pagination p1 mx-auto">
                                                        <ul>
                                                            <% if (pagination.page > 1) { %>
                                                                <a href="shop?count=<%= pagination.count %>&page=<%= pagination.page-1 %>"><i class="fa fa-angle-left"></i></a>
                                                            <% } %>
                                                            
                                                          <% if (locals.pagination.page > 2) { %>
                                                          <!-- <a href="?count=<%= pagination.count %>&page=<%= pagination.page-1 %>"><li><</li></a> -->
                                                          <% } %>
                                                          <% if (pagination.page > 1) { %>
                                                          <a href="?count=<%= pagination.count %>&page=<%= pagination.page-1 %>"><li><%= pagination.page-1 %></li></a>
                                                          <% } %>
                                                          <a class="is-active" href="#"><li><%= pagination.page %></li></a>
                                                          <% for (let i = pagination.page+1; i <= Math.min(pagination.totalPages,pagination.page+6); i++) { %>
                                                          <a href="?count=<%= pagination.count %>&page=<%= i %>"><li><%= i %></li></a>
                                                          <% } %>
                                                          <% if (pagination.page < pagination.totalPages-1) { %>
                                                          <!-- <a href="?count=<%= pagination.count %>&page=<%= pagination.page+1 %>"><li>></li></a> -->
                                                          <% } %>
                                                    
                                                          <% if (pagination.page < pagination.totalPages) { %>
                                                            <a href="shop?count=<%= pagination.count %>&page=<%= pagination.page+1 %>"><i class="fa fa-angle-right"></i></a>
                                                        <% } %>
                                                         
                                                        </ul>
                                                      </div>
                                               


                                                </div>
                                               
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- Shop Section End -->

                        <%-include('../partials/userfooter')-%>

                            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
                            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                            <script src="https://unpkg.com/sweetalert@2"></script> 


                            <script>
                        $(document).ready(function () {
                     
                           $(document).on ('click','.cartIncrement' ,function () {
                           
                                    console.log("vvvvvvvvvvv");
                                    // let count = document.querySelector('.cart-count')
                                    // let val =parseInt(count.textContent)
                                    let data = $(this).data('pro')
                                    console.log(data);
                                    $.ajax({
                                        url: '/addToCart',
                                        data: {
                                            productid: data
                                        },
                                        method: 'post',
                                        success: (response) => {
                                            if (response.response) {
                                           
                                                if (response.limit) {
                                                    Swal.fire(
                                                        'sorry!',
                                                        'sorry you have only buy 10 quantity or product i sout of stock',
                                                        'warning'
                                                    )
                                                } else {


                                                    // document.querySelector('.cart-count').textContent=val+1
                                                    Swal.fire({
                                                        position: 'center',
                                                        icon: 'success',
                                                        title: 'Product added to cart',
                                                        showConfirmButton: false,
                                                        timer: 1600
                                                    })
                                                    .then(() => {
                                                        location.reload()
                                                    })
                                                }
                                            } else {
                                                Swal.fire({
                                                    position: 'center',
                                                    icon: 'alert',
                                                    title: 'Please Login ',
                                                    showConfirmButton: false,
                                                    timer: 1600
                                                })
                                                setTimeout(() => {

                                                    window.location = '/login'
                                                }, 1700)
                                            }
                                        }
                                    })
                                })
                            
                        })



                                // $(document).ready(function () {
                                //     $('.add-produtToWishlist').click(function (e) {
                                //         e.preventDefault();
                                //         const productId = $(this).data('value');
                                //         console.log("clicked");
                                //         console.log("hjjjjjjjjjj", productId);
                                //         $.ajax({
                                //             url: '/add-to-wishList',
                                //             type: 'post',
                                //             data: { productId: productId }
                                //         }) 
                                //             .done((response) => {
                                //                if (response.response) {
                                //                  console.log(res.message);
                                //                  Swal.fire({
                                //                         position: 'center',
                                //                         icon: 'success',
                                //                         title: 'Product added to Wishlist',
                                //                         showConfirmButton: false,
                                //                         timer: 1600
                                //                     })
                                //                     .then(() => {
                                //                         location.reload()
                                //                     })
                                //                 }
                                //                 else{
                                //                     Swal.fire({
                                //                     position: 'center',
                                //                     icon: 'alert',
                                //                     title: 'Please Login ',
                                //                     showConfirmButton: false,
                                //                     timer: 1600
                                //                 })
                                //                 setTimeout(() => {

                                //                     window.location = '/login'
                                //                 }, 1700)
                                //                 }
                                //             })
                                //             .fail((err) => {
                                //                 console.log(err);
                                //             })
                                //     })
                                // })
                                $(document).ready(function () {
  $('.add-produtToWishlist').click(function (e) {
    e.preventDefault();
    const productId = $(this).data('value');
    console.log("clicked");
    console.log("hjjjjjjjjjj", productId);
    $.ajax({
      url: '/add-to-wishList',
      type: 'post',
      data: { productId: productId }
    })
      .done((res) => {
        console.log("ssss");
        console.log(res);

        if (res.response == true) {
          Swal.fire({
            position: 'center',
            icon: 'success',
            title: 'Product added to Wishlist',
            showConfirmButton: false,
            timer: 1600
          })
            .then(() => {
              location.reload();
            });
        } else {
          if (res.message === "Product already exists in the wishlist.") {
            Swal.fire({
              position: 'center',
              icon: 'error',
              title: 'Product already added to Wishlist',
              showConfirmButton: false,
              timer: 1600
            });
          } else {
                                                    Swal.fire({
                                                        position: 'center',
                                                        icon: 'alert',
                                                        title: 'Login needed',
                                                        showConfirmButton: false,
                                                        timer: 1600
                                                    })
                                                    setTimeout(() => {

                                                        window.location = '/login'
                                                    }, 1700)
                                                }
        }
      })
      .fail((err) => {
        console.log(err);
      });
  });
});


                                
                            

                            </script>